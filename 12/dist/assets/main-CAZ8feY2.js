import{c as y,a as T,b as D,u as q,d as X,r as d,j as e,P as W,L as m,s as k,e as R,S as Q,C as K,f as ee,g as se,h as te,T as H,N as ae,R as V,i as v,M as J,B as le,D as re,O as ne,k as ie,l as ce,m as oe,n as de}from"./index-4Bumhera.js";/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],P=y("book-open",xe);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Y=y("chevron-left",he);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Z=y("clock",me);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],pe=y("eye",ue);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],ge=y("grid-3x3",je);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],be=y("map-pin",fe);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],O=y("message-circle",Ne);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=[["path",{d:"M5 12h14",key:"1ays0h"}]],ye=y("minus",ve);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],F=y("phone",we);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ce=y("shield",ke);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],_e=y("shopping-bag",Se);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],$=y("shopping-cart",ze);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]],Ie=y("trending-up",Ee);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],B=y("user",$e);/**
 * @license lucide-react v0.486.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qe=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],U=y("x",qe),L=localStorage.getItem("user_id")||crypto.randomUUID();localStorage.setItem("user_id",L);console.log("🛍️ Cart store initialized for user:",L);const _=T((a,r)=>({items:[],isOpen:!1,initialize:async()=>{try{console.log("📦 Loading cart from API...");const n=await D.get(`/api/cart?userId=${L}`);n.data&&n.data.items?(console.log("✅ Cart loaded:",n.data.items),a({items:n.data.items})):console.warn("⚠️ API returned no cart items")}catch(n){console.error("❌ Error loading cart from server:",n)}},saveCart:async n=>{try{console.log("💾 Saving cart to API:",n),await D.post("/api/cart",{userId:L,items:n}),console.log("✅ Cart saved")}catch(s){console.error("❌ Error saving cart to server:",s)}},addItem:n=>{console.log("➕ Adding book to cart:",n),a(s=>{const t=s.items.find(o=>o.id===n.id);let l;return t?l=s.items.map(o=>o.id===n.id?{...o,quantity:o.quantity+1}:o):l=[...s.items,{...n,quantity:1}],r().saveCart(l),{items:l,isOpen:!0}})},removeItem:n=>{console.log("➖ Removing book from cart:",n),a(s=>{const t=s.items.filter(l=>l.id!==n);return r().saveCart(t),{items:t}})},clearCart:()=>{console.log("🗑️ Clearing cart"),a({items:[]}),r().saveCart([])}}));function Le(){const{books:a,loading:r,error:n,initialize:s,searchBooks:t}=q(),{addItem:l}=_(),o=X(),i=new URLSearchParams(o.search).get("search")||"";return d.useEffect(()=>{s()},[s]),d.useEffect(()=>{t(i)},[i,t]),r?e.jsx("div",{className:"text-center py-8",children:"טוען..."}):n?e.jsx("div",{className:"text-center py-8 text-red-600",children:n}):e.jsxs("div",{className:"p-4 max-w-6xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-center text-[#112a55]",children:"קטלוג הספרים"}),e.jsx("div",{className:"grid gap-6 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3",children:a.map(c=>e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden flex flex-col transform transition-transform duration-300 hover:scale-105",children:[c.image_url?e.jsx("img",{src:c.image_url,alt:c.title,className:"w-full h-[300px] object-contain bg-white rounded-t-2xl"}):e.jsx("img",{src:`https://via.placeholder.com/300x400.png?text=${encodeURIComponent(c.title)}`,alt:c.title,className:"w-full h-64 object-cover rounded-t-2xl"}),e.jsxs("div",{className:"p-4 flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-[#112a55] mb-2",children:c.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:c.description}),e.jsxs("p",{className:"text-md font-bold text-[#a48327]",children:[c.price," ₪"]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("button",{onClick:()=>l(c),className:"bg-[#7c1c2c] text-white py-2 px-4 rounded-lg hover:bg-[#66121f] flex items-center gap-2",children:[e.jsx($,{size:18})," ",e.jsx("span",{children:"קנייה מיידית"})]}),e.jsxs("div",{className:"flex gap-2 text-xl",children:[e.jsx("button",{className:"text-gray-500 hover:text-green-600",title:"הוספה לרשימת משאלות",children:e.jsx(W,{size:18})}),e.jsx(m,{to:`/books/${c.id}`,className:"text-gray-500 hover:text-blue-600",title:"צפייה בפרטים",children:e.jsx(pe,{size:18})})]})]})]})]},c.id))})]})}const z=T(a=>({user:null,loading:!0,error:null,initialize:async()=>{try{const{data:{session:r},error:n}=await k.getSession();if(n)throw n;const{data:{user:s},error:t}=await k.getUser();if(t)throw t;a({user:s,loading:!1,error:null})}catch(r){console.error("Error in auth initialization:",r),a({error:"שגיאה בטעינת המשתמש",loading:!1,user:null})}},signIn:async(r,n)=>{try{a({loading:!0,error:null});const{data:s,error:t}=await k.signIn(r,n);if(t)throw t;return a({user:s.user,loading:!1}),{success:!0}}catch(s){return console.error("Error in signIn:",s),a({error:"פרטי התחברות שגויים",loading:!1}),{success:!1,error:s}}},signUp:async(r,n)=>{try{a({loading:!0,error:null});const{data:s,error:t}=await k.signUp(r,n);if(t)throw t;return a({user:s.user,loading:!1}),{success:!0}}catch(s){return console.error("Error in signUp:",s),a({error:"שגיאה בהרשמה",loading:!1}),{success:!1,error:s}}},signOut:async()=>{try{const{error:r}=await k.signOut();if(r)throw r;a({user:null,loading:!1})}catch(r){console.error("Error in signOut:",r),a({error:"שגיאה בהתנתקות"})}}}));function Me(){console.log("🔵 Header component loaded");const[a,r]=d.useState(""),[n,s]=d.useState(!1),t=R();let l=null,o=()=>{},i=()=>{},c=()=>0;try{const u=z();l=u.user,o=u.signOut;const g=_();i=g.openCart,c=g.getItemsCount}catch(u){console.error("❌ Store loading error:",u)}const x=u=>{u.preventDefault(),console.log("🔍 Search submitted:",a),a.trim()&&t(`/?search=${encodeURIComponent(a)}`)},h=()=>{window.open("https://wa.me/972504181216","_blank")};return console.log("🟢 Rendering header component"),e.jsxs("header",{className:"w-full shadow-lg font-serif text-right bg-white",children:[e.jsxs("div",{className:"bg-[#f8f6f1] text-sm text-[#8b6f1f] px-6 py-2 flex justify-between items-center border-b",children:[e.jsxs("nav",{className:"flex gap-6",children:[e.jsx(m,{to:"/",className:"hover:text-[#a48327] transition",children:"ראשי"}),e.jsx(m,{to:"/about",className:"hover:text-[#a48327] transition",children:"אודותינו"}),e.jsx(m,{to:"/categories",className:"hover:text-[#a48327] transition",children:"קטגוריות"}),e.jsx(m,{to:"/contact",className:"hover:text-[#a48327] transition",children:"יצירת קשר"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-xs",children:"משלוח חינם בקנייה מעל 250 ₪"}),e.jsx("span",{className:"text-xs border-r pr-4",children:"הנחת מזומן 10%"})]})]}),e.jsx("div",{className:"py-6 px-6",children:e.jsxs("div",{className:"flex flex-col items-center gap-6",children:[e.jsxs(m,{to:"/",className:"flex flex-col justify-center items-center gap-2",children:[e.jsx("img",{src:"/logo.png",alt:"ספרי קודש תלפיות",className:"h-48 object-contain",onError:u=>{u.target.style.display="none",console.warn("⚠️ לוגו לא נטען")},style:{filter:"brightness(0.85)"}}),e.jsx("p",{className:"text-[#112a55] text-2xl font-bold tracking-wide",style:{fontFamily:"Frank Ruhl Libre, serif"},children:"המקום המושלם לספרי קודש במחירים נוחים"})]}),e.jsxs("div",{className:"flex gap-8 items-center",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("button",{onClick:()=>s(!0),className:"w-16 h-16 bg-[#112a55] rounded-full flex items-center justify-center shadow-lg hover:bg-[#1a3c70] transition-colors",children:e.jsx(O,{size:32,className:"text-white"})}),e.jsx("span",{className:"text-[#a48327]",children:"יצירת קשר"})]}),e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(m,{to:"/categories",className:"w-16 h-16 bg-[#112a55] rounded-full flex items-center justify-center shadow-lg hover:bg-[#1a3c70] transition-colors",children:e.jsx(ge,{size:32,className:"text-white"})}),e.jsx("span",{className:"text-[#a48327]",children:"כל הקטגוריות"})]})]})]})}),e.jsxs("div",{className:"bg-[#112a55] text-white px-6 py-4 flex flex-col lg:flex-row justify-between items-center gap-4",children:[e.jsxs("form",{onSubmit:x,className:"flex w-full max-w-md relative",children:[e.jsx("input",{type:"text",placeholder:"חפש ספרים...",value:a,onChange:u=>r(u.target.value),className:"w-full px-4 py-2 pr-10 rounded-lg text-black text-sm border-2 border-transparent focus:border-[#a48327] outline-none transition-all duration-200"}),e.jsx("button",{type:"submit",className:"absolute left-2 top-1/2 -translate-y-1/2 text-gray-500 hover:text-[#a48327] transition-colors",children:e.jsx(Q,{size:20})})]}),e.jsxs("div",{className:"flex items-center gap-6 text-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[#f9e79f]",children:[e.jsx(F,{size:20,strokeWidth:1.5,className:"rotate-90"}),e.jsx("span",{children:"050-418-1216"})]}),l?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(m,{to:"/user",className:"hover:text-yellow-400",children:e.jsx(B,{size:20,strokeWidth:1.5})}),e.jsx("button",{onClick:o,className:"text-sm hover:text-yellow-400",children:"התנתק"})]}):e.jsx(m,{to:"/login",className:"hover:text-yellow-400",children:e.jsx(B,{size:20,strokeWidth:1.5})}),e.jsxs("button",{onClick:i,title:"סל קניות",className:"relative hover:text-yellow-400",children:[e.jsx($,{size:20,strokeWidth:1.5}),e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-xs px-1 rounded-full",children:c()})]})]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full relative",children:[e.jsx("button",{onClick:()=>s(!1),className:"absolute left-4 top-4 text-gray-500 hover:text-gray-700",children:e.jsx(U,{size:24})}),e.jsx("h2",{className:"text-2xl font-bold text-[#112a55] mb-6",children:"יצירת קשר"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:h,className:"w-full bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(O,{size:24}),e.jsx("span",{children:"שלח הודעת WhatsApp"})]}),e.jsx(m,{to:"/contact",onClick:()=>s(!1),className:"w-full bg-[#112a55] text-white py-3 rounded-lg hover:bg-[#1a3c70] transition-colors flex items-center justify-center",children:"השאר הודעה"}),e.jsx("p",{className:"text-center text-gray-500 text-sm",children:"אנו מתחייבים לחזור אליך תוך יום עסקים אחד"})]})]})})]})}function Re(){return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-all duration-300",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:"https://images.pexels.com/photos/159866/books-book-pages-read-literature-159866.jpeg",alt:"מבצע מיוחד",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end p-6",children:e.jsxs("div",{className:"text-white",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"מבצע מיוחד"}),e.jsx("p",{className:"text-sm opacity-90",children:"קבלו 20% הנחה על כל ספרי הלכה"})]})})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-[#a48327]",children:"20% הנחה"}),e.jsxs(m,{to:"/categories",className:"flex items-center gap-2 text-[#112a55] hover:text-[#1a3c70] transition-colors",children:[e.jsx("span",{children:"לקטלוג"}),e.jsx(_e,{size:20})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg overflow-hidden transform hover:scale-105 transition-all duration-300",children:[e.jsxs("div",{className:"relative h-48 overflow-hidden",children:[e.jsx("img",{src:"https://images.pexels.com/photos/2041540/pexels-photo-2041540.jpeg",alt:"ספרים חדשים",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent flex items-end p-6",children:e.jsxs("div",{className:"text-white",children:[e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"חדש על המדף"}),e.jsx("p",{className:"text-sm opacity-90",children:"ספרים חדשים מגיעים כל שבוע"})]})})]}),e.jsx("div",{className:"p-6 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-2xl font-bold text-[#a48327]",children:"מחירי השקה"}),e.jsxs(m,{to:"/categories",className:"flex items-center gap-2 text-[#112a55] hover:text-[#1a3c70] transition-colors",children:[e.jsx("span",{children:"לחדשים"}),e.jsx(Ie,{size:20})]})]})})]})]})}const Fe=()=>{const a=d.useRef(null),[r,n]=d.useState([]),[s,t]=d.useState(!0),[l,o]=d.useState(null),{getNewArrivals:i}=q(),{addItem:c}=_(),[x,h]=d.useState(!0);d.useEffect(()=>{(async()=>{try{t(!0),o(null);const N=await i(),j=[...N,...N,...N];n(j)}catch(N){console.error("Error fetching new arrivals:",N),o("שגיאה בטעינת הספרים")}finally{t(!1)}})()},[i]),d.useEffect(()=>{const p=a.current;if(!p||!x)return;let N,j=0;const C=.5,f=w=>{j||(j=w);const S=w-j;j=w,p.scrollLeft+=C*S,p.scrollLeft>=p.scrollWidth/3&&(p.scrollLeft=0,j=w),N=requestAnimationFrame(f)};return N=requestAnimationFrame(f),()=>{N&&cancelAnimationFrame(N)}},[r,x]);const u=p=>{h(!1);const N=a.current;if(!N)return;const j=p==="left"?-300:300;N.scrollBy({left:j,behavior:"smooth"})},g=()=>{h(!1)},b=()=>{h(!0)};return s?e.jsx("div",{className:"text-center py-8",children:"טוען..."}):l?e.jsx("div",{className:"text-center py-8 text-red-600",children:l}):e.jsxs("div",{className:"w-full overflow-hidden py-4 bg-[#f4ecd6] relative",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-right text-[#2c1810] border-b-2 border-[#8b6f1f] pb-2 pr-4",children:"חדשים באתר"}),e.jsx("button",{onClick:()=>u("right"),className:"absolute left-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white p-2 rounded-full shadow-lg z-10 transition-all",children:e.jsx(Y,{size:24,className:"text-[#2c1810]"})}),e.jsx("button",{onClick:()=>u("left"),className:"absolute right-2 top-1/2 transform -translate-y-1/2 bg-white/80 hover:bg-white p-2 rounded-full shadow-lg z-10 transition-all",children:e.jsx(K,{size:24,className:"text-[#2c1810]"})}),e.jsx("div",{ref:a,className:"flex gap-6 overflow-x-hidden whitespace-nowrap px-4",style:{scrollBehavior:"auto"},onMouseEnter:g,onMouseLeave:b,children:r.map((p,N)=>e.jsxs("div",{className:"flex-shrink-0 w-48 cursor-pointer relative group bg-white rounded-xl shadow-md p-3",children:[e.jsxs(m,{to:`/books/${p.id}`,children:[e.jsx("img",{src:p.image_url||`https://via.placeholder.com/300x400.png?text=${encodeURIComponent(p.title)}`,alt:p.title,className:"w-full h-32 object-cover rounded-lg shadow group-hover:opacity-90 transition-opacity"}),e.jsx("p",{className:"text-center mt-3 font-serif text-lg text-[#2c1810]",children:p.title}),e.jsxs("p",{className:"text-center text-[#8b6f1f] font-bold mt-1",children:[p.price," ₪"]})]}),e.jsxs("button",{onClick:()=>c(p),className:"absolute bottom-0 left-0 right-0 bg-[#7c1c2c] text-white py-2 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 rounded-b-xl",children:[e.jsx($,{size:16}),"הוסף לסל"]})]},`${p.id}-${N}`))})]})},Ue=()=>{const[a,r]=d.useState([]),[n,s]=d.useState(!0),[t,l]=d.useState(null),{getNewInMarket:o}=q(),{addItem:i}=_(),[c,x]=d.useState(0),h=3;d.useEffect(()=>{(async()=>{try{s(!0),l(null);const p=await o();r(p)}catch(p){console.error("Error fetching new in market books:",p),l("שגיאה בטעינת הספרים")}finally{s(!1)}})()},[o]);const u=Math.ceil(a.length/h),g=a.slice(c*h,c*h+h);return n?e.jsx("div",{className:"text-center py-8",children:"טוען..."}):t?e.jsx("div",{className:"text-center py-8 text-red-600",children:t}):e.jsxs("div",{className:"w-full py-6 bg-[#f4ecd6]",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-right text-[#2c1810] border-b-2 border-[#8b6f1f] pb-2 pr-4",children:"חדשים בשוק"}),e.jsx("div",{className:"flex gap-8 justify-center px-4",children:g.map(b=>e.jsxs("div",{className:"w-48 cursor-pointer relative group bg-white rounded-xl shadow-md p-3",children:[e.jsxs(m,{to:`/books/${b.id}`,children:[e.jsx("img",{src:b.image_url?b.image_url:`https://via.placeholder.com/300x400.png?text=${encodeURIComponent(b.title)}`,alt:b.title,className:"w-full h-32 object-cover rounded-lg shadow group-hover:opacity-90 transition-opacity"}),e.jsx("p",{className:"text-center mt-3 font-serif text-lg text-[#2c1810]",children:b.title}),e.jsxs("p",{className:"text-center text-[#8b6f1f] font-bold mt-1",children:[b.price," ₪"]})]}),e.jsxs("button",{onClick:()=>i(b),className:"absolute bottom-0 left-0 right-0 bg-[#7c1c2c] text-white py-2 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2 rounded-b-xl",children:[e.jsx($,{size:16}),"הוסף לסל"]})]},b.id))}),e.jsx("div",{className:"flex justify-center mt-6 gap-2",children:Array.from({length:u}).map((b,p)=>e.jsx("button",{className:`w-3 h-3 rounded-full transition-colors ${p===c?"bg-[#2c1810]":"bg-[#8b6f1f]"} hover:bg-[#2c1810]`,onClick:()=>x(p)},p))})]})};function Ae(a){const r={},n=[];return a.forEach(s=>{r[s.id]={...s,children:[]}}),a.forEach(s=>{var t;s.parent_id?(t=r[s.parent_id])==null||t.children.push(r[s.id]):n.push(r[s.id])}),n}function De({books:a,categoryName:r,onClose:n}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-2xl font-bold text-[#112a55]",children:["ספרים בקטגוריית ",r]}),e.jsx("button",{onClick:n,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.length>0?a.map(s=>e.jsx(m,{to:`/books/${s.id}`,className:"bg-[#f8f6f1] rounded-xl p-4 hover:shadow-lg transition-all duration-300",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:s.image_url||`https://via.placeholder.com/100x150.png?text=${encodeURIComponent(s.title)}`,alt:s.title,className:"w-24 h-32 object-cover rounded"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-[#112a55]",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.author}),e.jsxs("p",{className:"text-[#a48327] font-bold mt-1",children:[s.price," ₪"]})]})]})},s.id)):e.jsx("p",{className:"col-span-full text-center text-gray-600",children:"אין ספרים בקטגוריה זו"})})]})})}function Pe({categories:a,books:r,onViewBooks:n}){return e.jsx("div",{className:"space-y-4",children:a.map(s=>e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-bold text-[#112a55]",children:s.name}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>n(s.name),className:"flex items-center gap-2 text-[#a48327] hover:text-[#8b6f1f] transition-colors",title:"צפה בכל הספרים",children:[e.jsx(P,{size:20}),e.jsx("span",{children:"כל הספרים"})]}),s.children.length>0&&e.jsx(Y,{className:"text-[#a48327]",size:20})]})]}),s.children.length>0&&e.jsx("div",{className:"mt-4 pr-6 space-y-3",children:s.children.map(t=>e.jsx("div",{className:"bg-[#f8f6f1] rounded-lg p-4 hover:bg-[#f0ece3] transition-colors duration-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-[#666]",children:t.name}),e.jsxs("button",{onClick:()=>n(t.name),className:"flex items-center gap-2 text-[#a48327] hover:text-[#8b6f1f] transition-colors",title:"צפה בכל הספרים",children:[e.jsx(P,{size:18}),e.jsx("span",{className:"text-sm",children:"כל הספרים"})]})]})},t.id))})]},s.id))})}function Oe(){const{categories:a,loading:r,error:n,initialize:s}=ee(),{books:t,loading:l,error:o,initialize:i}=q(),[c,x]=d.useState(""),[h,u]=d.useState([]),[g,b]=d.useState(null),p=Ae(a);d.useEffect(()=>{s(),i()},[s,i]),d.useEffect(()=>{if(c){const f=t.filter(w=>{var S,I;return w.title.toLowerCase().includes(c.toLowerCase())||((S=w.author)==null?void 0:S.toLowerCase().includes(c.toLowerCase()))||((I=w.category)==null?void 0:I.toLowerCase().includes(c.toLowerCase()))});u(f)}else u([])},[c,t]);const N=f=>{const w=t.filter(S=>{var I;return((I=S.category)==null?void 0:I.toLowerCase())===f.toLowerCase()});b({name:f,books:w})},j=r||l,C=n||o;return j?e.jsx("div",{className:"text-center py-8",children:"טוען..."}):C?e.jsx("div",{className:"text-center py-8 text-red-600",children:C}):a.length===0?e.jsx("div",{className:"text-center py-8",children:"אין קטגוריות זמינות"}):e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-[#112a55] mb-2",children:"קטגוריות ספרים"}),e.jsx("p",{className:"text-gray-600",children:"מצא את הספר המושלם לפי קטגוריה"})]}),e.jsxs("div",{className:"relative mb-8",children:[e.jsx("input",{type:"text",placeholder:"חפש ספר או קטגוריה...",value:c,onChange:f=>x(f.target.value),className:"w-full px-4 py-3 pr-12 rounded-xl border border-gray-300 focus:border-[#a48327] focus:ring-1 focus:ring-[#a48327] outline-none"}),e.jsx(Q,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20})]}),c?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(f=>e.jsx(m,{to:`/books/${f.id}`,className:"bg-white rounded-xl p-4 shadow-md hover:shadow-lg transition-shadow duration-300",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:f.image_url||`https://via.placeholder.com/100x150.png?text=${encodeURIComponent(f.title)}`,alt:f.title,className:"w-24 h-32 object-cover rounded"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-[#112a55]",children:f.title}),e.jsx("p",{className:"text-sm text-gray-600",children:f.author}),e.jsxs("p",{className:"text-[#a48327] font-bold mt-2",children:[f.price," ₪"]})]})]})},f.id))}):e.jsx(Pe,{categories:p,books:t,onViewBooks:N}),g&&e.jsx(De,{books:g.books,categoryName:g.name,onClose:()=>b(null)})]})}function Be(){const{id:a}=se(),{books:r,loading:n,error:s}=q(),{addItem:t}=_(),l=r.find(i=>i.id===parseInt(a)),o=d.useMemo(()=>l?r.filter(i=>i.category===l.category&&i.id!==l.id).slice(0,4):[],[r,l]);return n?e.jsx("div",{className:"text-center py-8",children:"טוען..."}):s?e.jsx("div",{className:"text-center py-8 text-red-600",children:s}):l?e.jsxs("div",{className:"max-w-6xl mx-auto p-4",children:[e.jsx(m,{to:"/",className:"text-[#112a55] hover:text-[#1a3c70] transition-colors mb-6 inline-flex items-center gap-2",children:"← חזרה לקטלוג"}),e.jsx("div",{className:"bg-white shadow-xl rounded-2xl overflow-hidden mb-12",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 p-8",children:[e.jsx("div",{className:"flex items-center justify-center bg-[#f8f6f1] rounded-xl p-8",children:e.jsx("img",{src:l.image_url||`https://via.placeholder.com/400x600.png?text=${encodeURIComponent(l.title)}`,alt:l.title,className:"max-h-[500px] object-contain rounded-lg shadow-lg"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-2",children:l.title}),e.jsx("p",{className:"text-xl text-gray-600 mb-4",children:l.author||"מחבר לא ידוע"}),e.jsx("div",{className:"flex items-center gap-2 text-[#a48327]",children:e.jsx("span",{className:"text-sm bg-[#fdf6ec] px-3 py-1 rounded-full",children:l.category})})]}),e.jsx("p",{className:"text-gray-700 text-lg leading-relaxed border-t border-b border-gray-100 py-4",children:l.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-3xl font-bold text-[#a48327]",children:[l.price," ₪"]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm ${l.availability==="available"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:l.availability==="available"?"✓ במלאי":"× אזל מהמלאי"})]}),e.jsxs("button",{onClick:()=>l.availability==="available"&&t(l),className:`w-full py-4 rounded-xl flex items-center justify-center gap-3 text-lg font-bold transition-all duration-300 ${l.availability==="available"?"bg-[#7c1c2c] text-white hover:bg-[#66121f] transform hover:scale-105":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,disabled:l.availability!=="available",children:[e.jsx($,{size:24}),"הוסף לסל הקניות"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 pt-6 border-t",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(te,{className:"mx-auto text-[#112a55] mb-2",size:24}),e.jsx("span",{className:"text-sm",children:"משלוח חינם"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Z,{className:"mx-auto text-[#112a55] mb-2",size:24}),e.jsx("span",{className:"text-sm",children:"משלוח מהיר"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(Ce,{className:"mx-auto text-[#112a55] mb-2",size:24}),e.jsx("span",{className:"text-sm",children:"אחריות מלאה"})]})]})]})]})}),o.length>0&&e.jsxs("div",{className:"bg-white shadow-lg rounded-2xl p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#112a55] mb-6",children:"ספרים דומים"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6",children:o.map(i=>e.jsxs("div",{className:"bg-[#f8f6f1] rounded-xl p-4 transition-all duration-300 hover:shadow-lg hover:scale-105",children:[e.jsxs(m,{to:`/books/${i.id}`,children:[e.jsx("img",{src:i.image_url||`https://via.placeholder.com/200x300.png?text=${encodeURIComponent(i.title)}`,alt:i.title,className:"w-full h-48 object-contain mb-4"}),e.jsx("h3",{className:"font-bold text-[#112a55] mb-1",children:i.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:i.author}),e.jsxs("p",{className:"text-[#a48327] font-bold mb-3",children:[i.price," ₪"]})]}),e.jsxs("button",{onClick:()=>t(i),className:"w-full bg-[#7c1c2c] text-white py-2 rounded-lg hover:bg-[#66121f] flex items-center justify-center gap-2",children:[e.jsx($,{size:16}),"הוסף לסל"]})]},i.id))})]})]}):e.jsx("div",{className:"text-center py-8",children:"הספר לא נמצא"})}function Te(){return e.jsxs("div",{className:"max-w-4xl mx-auto p-4 text-center",children:[e.jsx("h2",{className:"text-3xl font-bold text-[#112a55] mb-4",children:"404 - העמוד לא נמצא"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"העמוד שחיפשת אינו קיים. אולי תרצה לחזור לעמוד הראשי?"}),e.jsx(m,{to:"/",className:"bg-[#a48327] hover:bg-[#8b6f1f] text-white px-4 py-2 rounded",children:"חזרה לעמוד הראשי"})]})}function We(){return e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"אודות ספרי קודש תלפיות"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"מי אנחנו"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:'חנות ספרי קודש תלפיות הוקמה בשנת תש"פ מתוך מטרה להנגיש ספרי קודש איכותיים במחירים הוגנים. החנות שלנו מתמחה במגוון רחב של ספרי קודש, מהדורות מיוחדות, וספרי לימוד לכל הגילאים.'})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"המטרה שלנו"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"אנו שואפים להיות הכתובת המועדפת לרכישת ספרי קודש, תוך הקפדה על:"}),e.jsxs("ul",{className:"list-disc list-inside mt-2 space-y-2 text-gray-700",children:[e.jsx("li",{children:"איכות מוצרים גבוהה"}),e.jsx("li",{children:"שירות לקוחות מצוין"}),e.jsx("li",{children:"מחירים הוגנים"}),e.jsx("li",{children:"מבחר עשיר ומתחדש"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"שירותים נוספים"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"הזמנות מיוחדות של ספרים"}),e.jsx("li",{children:"משלוחים לכל הארץ"}),e.jsx("li",{children:"כריכה ותיקון ספרים"}),e.jsx("li",{children:"ייעוץ מקצועי בבחירת ספרים"})]})]})]})]})}function Qe(){const[a,r]=d.useState({name:"",email:"",phone:"",message:""}),[n,s]=d.useState(""),t=async o=>{o.preventDefault(),s("שולח..."),setTimeout(()=>{s("ההודעה נשלחה בהצלחה!"),r({name:"",email:"",phone:"",message:""})},1e3)},l=o=>{const{name:i,value:c}=o.target;r(x=>({...x,[i]:c}))};return e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"צור קשר"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-4",children:"פרטי התקשרות"}),e.jsxs("div",{className:"space-y-4 text-gray-700",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"כתובת:"}),e.jsx("p",{children:"רחוב הרב קוק 12, ירושלים"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"טלפון:"}),e.jsx("p",{children:"050-418-1216"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:"שעות פעילות:"}),e.jsx("p",{children:"ימים א'-ה': 9:00-20:00"}),e.jsx("p",{children:"יום ו': 9:00-13:00"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold",children:'דוא"ל:'}),e.jsx("p",{children:"info@talpiot-books.co.il"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-4",children:"טופס יצירת קשר"}),e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700 mb-1",children:"שם מלא"}),e.jsx("input",{type:"text",id:"name",name:"name",value:a.name,onChange:l,required:!0,className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 mb-1",children:'דוא"ל'}),e.jsx("input",{type:"email",id:"email",name:"email",value:a.email,onChange:l,required:!0,className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-gray-700 mb-1",children:"טלפון"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:a.phone,onChange:l,className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-gray-700 mb-1",children:"הודעה"}),e.jsx("textarea",{id:"message",name:"message",value:a.message,onChange:l,required:!0,rows:"4",className:"w-full border rounded p-2"})]}),e.jsx("button",{type:"submit",className:"bg-[#a48327] text-white py-2 px-6 rounded hover:bg-[#8b6f1f] transition-colors",children:"שלח הודעה"}),n&&e.jsx("p",{className:"text-green-600 text-center",children:n})]})]})]})]})}function He(){const a=R(),{signIn:r,signUp:n,error:s}=z(),[t,l]=d.useState(!0),[o,i]=d.useState({email:"",password:""}),c=async h=>{h.preventDefault();const{email:u,password:g}=o;(t?await r(u,g):await n(u,g)).success&&a("/user")},x=h=>{const{name:u,value:g}=h.target;i(b=>({...b,[u]:g}))};return e.jsxs("div",{className:"max-w-md mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6 text-center",children:t?"התחברות":"הרשמה"}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("form",{onSubmit:c,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 mb-1",children:'דוא"ל'}),e.jsx("input",{type:"email",id:"email",name:"email",value:o.email,onChange:x,required:!0,className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-700 mb-1",children:"סיסמה"}),e.jsx("input",{type:"password",id:"password",name:"password",value:o.password,onChange:x,required:!0,className:"w-full border rounded p-2"})]}),s&&e.jsx("p",{className:"text-red-600 text-sm",children:s}),e.jsx("button",{type:"submit",className:"w-full bg-[#a48327] text-white py-2 rounded hover:bg-[#8b6f1f] transition-colors",children:t?"התחבר":"הירשם"}),e.jsxs("p",{className:"text-center text-gray-600",children:[t?"אין לך חשבון?":"כבר יש לך חשבון?",e.jsx("button",{type:"button",onClick:()=>l(!t),className:"text-[#112a55] hover:underline mr-1",children:t?"הירשם":"התחבר"})]})]})})]})}function Ve(){const{user:a}=z(),[r,n]=d.useState({name:"",phone:"",address:""}),[s,t]=d.useState(""),[l,o]=d.useState(!0);d.useEffect(()=>{a&&(async()=>{try{o(!0);const{data:h,error:u}=await k.from("profiles").select("*").eq("id",a.id).single();if(u)throw u;h&&n({name:h.name||"",phone:h.phone||"",address:h.address||""})}catch(h){console.error("Error fetching profile:",h),t("שגיאה בטעינת הפרופיל")}finally{o(!1)}})()},[a]);const i=async x=>{x.preventDefault(),t("שומר שינויים...");try{const{error:h}=await k.from("profiles").upsert({id:a.id,...r,updated_at:new Date});if(h)throw h;t("הפרטים נשמרו בהצלחה!")}catch(h){console.error("Error updating profile:",h),t("שגיאה בשמירת הפרטים")}},c=x=>{const{name:h,value:u}=x.target;n(g=>({...g,[h]:u}))};return l?e.jsx("div",{children:"טוען..."}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-[#112a55] mb-6",children:"פרטים אישיים"}),e.jsxs("form",{onSubmit:i,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700 mb-1",children:"שם מלא"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:c,className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 mb-1",children:'דוא"ל'}),e.jsx("input",{type:"email",value:a==null?void 0:a.email,disabled:!0,className:"w-full border rounded p-2 bg-gray-100"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-gray-700 mb-1",children:"טלפון"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:r.phone,onChange:c,className:"w-full border rounded p-2"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-gray-700 mb-1",children:"כתובת"}),e.jsx("textarea",{id:"address",name:"address",value:r.address,onChange:c,rows:"3",className:"w-full border rounded p-2"})]}),e.jsx("button",{type:"submit",className:"bg-[#a48327] text-white py-2 px-6 rounded hover:bg-[#8b6f1f] transition-colors",children:"שמור שינויים"}),s&&e.jsx("p",{className:s.includes("שגיאה")?"text-red-600":"text-green-600",children:s})]})]})}function Je(){const[a,r]=d.useState([]),[n,s]=d.useState(!0),[t,l]=d.useState(null),{user:o}=z();return d.useEffect(()=>{o&&(async()=>{try{s(!0);const{data:c,error:x}=await k.from("orders").select(`
            *,
            order_items:order_items (
              *,
              book:books (
                title,
                price
              )
            )
          `).eq("user_id",o.id).order("created_at",{ascending:!1});if(x)throw x;r(c||[])}catch(c){console.error("Error fetching orders:",c),l("שגיאה בטעינת ההזמנות")}finally{s(!1)}})()},[o]),n?e.jsx("div",{children:"טוען הזמנות..."}):t?e.jsx("div",{className:"text-red-600",children:t}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-[#112a55] mb-6",children:"ההזמנות שלי"}),a.length===0?e.jsx("p",{className:"text-gray-600",children:"עדיין אין הזמנות"}):e.jsx("div",{className:"space-y-4",children:a.map(i=>e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{className:"font-bold",children:["הזמנה #",i.id.slice(0,8)]}),e.jsx("span",{className:"text-sm text-gray-600",children:new Date(i.created_at).toLocaleDateString("he-IL")})]}),e.jsx("div",{className:"space-y-2",children:i.order_items.map(c=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[c.book.title," (x",c.quantity,")"]}),e.jsxs("span",{children:[c.price," ₪"]})]},c.id))}),e.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[e.jsxs("span",{className:"font-bold",children:['סה"כ: ',i.total," ₪"]}),e.jsx("span",{className:`px-2 py-1 rounded text-sm ${i.status==="completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:i.status==="completed"?"הושלם":"בטיפול"})]})]},i.id))})]})}function Ye(){const[a,r]=d.useState([]),[n,s]=d.useState(!0),[t,l]=d.useState(null),{user:o}=z(),i=async()=>{if(o)try{s(!0),l(null);const{data:x,error:h}=await k.from("wishlists").select(`
          *,
          book:books (
            id,
            title,
            author,
            price,
            image_url
          )
        `).eq("user_id",o.id);if(h)throw h;r(x||[])}catch(x){console.error("Error fetching wishlist:",x),l("שגיאה בטעינת רשימת המשאלות")}finally{s(!1)}};d.useEffect(()=>{i()},[o]);const c=async x=>{try{l(null);const{error:h}=await k.from("wishlists").delete().eq("id",x);if(h)throw h;await i()}catch(h){console.error("Error removing from wishlist:",h),l("שגיאה במחיקה מרשימת המשאלות")}};return n?e.jsx("div",{className:"text-center py-4",children:"טוען רשימת משאלות..."}):t?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-red-600 mb-2",children:t}),e.jsx("button",{onClick:i,className:"text-[#112a55] hover:underline",children:"נסה שוב"})]}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-[#112a55] mb-6",children:"רשימת המשאלות שלי"}),a.length===0?e.jsx("p",{className:"text-gray-600",children:"רשימת המשאלות ריקה"}):e.jsx("div",{className:"grid gap-4",children:a.map(x=>e.jsxs("div",{className:"flex items-center gap-4 border rounded-lg p-4 hover:shadow-lg transition-shadow",children:[e.jsx("img",{src:x.book.image_url||`https://via.placeholder.com/200x300.png?text=${encodeURIComponent(x.book.title)}`,alt:x.book.title,className:"w-20 h-28 object-contain rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx(m,{to:`/books/${x.book.id}`,className:"font-bold text-[#112a55] hover:text-[#1a3c70] transition-colors",children:x.book.title}),x.book.author&&e.jsx("p",{className:"text-gray-600 text-sm",children:x.book.author}),e.jsxs("p",{className:"text-[#a48327] font-bold mt-1",children:[x.book.price," ₪"]})]}),e.jsx("button",{onClick:()=>c(x.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-full transition-colors",title:"הסר מרשימת המשאלות",children:e.jsx(H,{size:20})})]},x.id))})]})}function Ze(){const{user:a,loading:r}=z();return r?e.jsx("div",{className:"text-center py-8",children:"טוען..."}):a?e.jsxs("div",{className:"max-w-6xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"אזור אישי"}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-8",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-6",children:e.jsxs("nav",{className:"space-y-2",children:[e.jsx(m,{to:"/user",className:"block py-2 px-4 rounded hover:bg-gray-100 transition",children:"פרופיל"}),e.jsx(m,{to:"/user/orders",className:"block py-2 px-4 rounded hover:bg-gray-100 transition",children:"הזמנות"}),e.jsx(m,{to:"/user/wishlist",className:"block py-2 px-4 rounded hover:bg-gray-100 transition",children:"רשימת משאלות"})]})}),e.jsx("div",{className:"md:col-span-3 bg-white rounded-xl shadow-lg p-6",children:e.jsxs(V,{children:[e.jsx(v,{index:!0,element:e.jsx(Ve,{})}),e.jsx(v,{path:"orders",element:e.jsx(Je,{})}),e.jsx(v,{path:"wishlist",element:e.jsx(Ye,{})})]})})]})]}):e.jsx(ae,{to:"/login",replace:!0})}function Ge(){var b,p,N;const a=R(),{items:r,getTotal:n,clearCart:s}=_(),{user:t}=z(),[l,o]=d.useState({name:((b=t==null?void 0:t.user_metadata)==null?void 0:b.name)||"",phone:((p=t==null?void 0:t.user_metadata)==null?void 0:p.phone)||"",email:(t==null?void 0:t.email)||"",address:((N=t==null?void 0:t.user_metadata)==null?void 0:N.address)||"",notes:""}),[i,c]=d.useState(""),[x,h]=d.useState(!1);if(r.length===0&&!x)return e.jsxs("div",{className:"max-w-4xl mx-auto p-8 text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-[#112a55] mb-4",children:"העגלה ריקה"}),e.jsx("button",{onClick:()=>a("/"),className:"text-[#a48327] hover:text-[#8b6f1f]",children:"חזרה לחנות"})]});if(x)return e.jsx("div",{className:"max-w-4xl mx-auto p-8 text-center",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-[#112a55]",children:"תודה על הקנייה!"}),e.jsx("p",{className:"text-xl text-[#a48327]",children:"ההזמנה התקבלה בהצלחה"}),e.jsxs("div",{className:"text-gray-600 space-y-2",children:[e.jsx("p",{children:"שלחנו לך אימייל עם פרטי ההזמנה."}),e.jsx("p",{children:"ניצור איתך קשר בהקדם לתיאום התשלום והמשלוח."})]}),e.jsxs("div",{className:"pt-6 border-t",children:[e.jsx("p",{className:"text-lg font-semibold text-[#112a55] mb-4",children:"המשך יום נעים!"}),e.jsx("p",{className:"text-gray-500",children:"נתראה שוב בקרוב 😊"})]}),e.jsx("button",{onClick:()=>a("/"),className:"mt-6 bg-[#a48327] text-white py-3 px-8 rounded-lg hover:bg-[#8b6f1f] transition-colors",children:"חזרה לחנות"})]})});const u=async j=>{j.preventDefault(),c("שולח הזמנה...");try{const{data:C,error:f}=await k.from("orders").insert({user_id:t.id,total:n(),shipping_address:l.address,phone:l.phone,notes:l.notes}).select().single();if(f)throw f;const w=r.map(E=>({order_id:C.id,book_id:E.id,quantity:E.quantity,price:E.price})),{error:S}=await k.from("order_items").insert(w);if(S)throw S;const G={orderNumber:C.id.slice(0,8).toUpperCase(),customerName:l.name,customerEmail:l.email,customerPhone:l.phone,items:r.map(E=>({title:E.title,quantity:E.quantity,price:E.price})),total:n(),shippingAddress:l.address},{error:A}=await k.functions.invoke("send-order-email",{body:{orderData:G}});A&&console.error("Error sending email:",A),c("ההזמנה התקבלה בהצלחה!"),s(),h(!0)}catch(C){console.error("Error creating order:",C),c("שגיאה בשליחת ההזמנה. אנא נסה שוב.")}},g=j=>{const{name:C,value:f}=j.target;o(w=>({...w,[C]:f}))};return e.jsxs("div",{className:"max-w-6xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-8",children:"סיום הזמנה"}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-6",children:"פרטי התקשרות"}),e.jsxs("form",{onSubmit:u,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700 mb-1",children:"שם מלא *"}),e.jsx("input",{type:"text",id:"name",name:"name",value:l.name,onChange:g,required:!0,className:"w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-[#a48327] focus:border-transparent outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-gray-700 mb-1",children:"טלפון *"}),e.jsxs("div",{className:"relative",children:[e.jsx(F,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:l.phone,onChange:g,required:!0,className:"w-full border rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-[#a48327] focus:border-transparent outline-none",placeholder:"050-1234567"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-700 mb-1",children:'דוא"ל *'}),e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:18}),e.jsx("input",{type:"email",id:"email",name:"email",value:l.email,onChange:g,required:!0,className:"w-full border rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-[#a48327] focus:border-transparent outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-gray-700 mb-1",children:"כתובת למשלוח *"}),e.jsxs("div",{className:"relative",children:[e.jsx(be,{className:"absolute right-3 top-3 text-gray-400",size:18}),e.jsx("textarea",{id:"address",name:"address",value:l.address,onChange:g,required:!0,rows:"2",className:"w-full border rounded-lg px-4 py-2 pr-10 focus:ring-2 focus:ring-[#a48327] focus:border-transparent outline-none"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",className:"block text-gray-700 mb-1",children:"הערות להזמנה"}),e.jsx("textarea",{id:"notes",name:"notes",value:l.notes,onChange:g,rows:"3",className:"w-full border rounded-lg px-4 py-2 focus:ring-2 focus:ring-[#a48327] focus:border-transparent outline-none"})]}),e.jsx("button",{type:"submit",className:"w-full bg-[#7c1c2c] text-white py-3 rounded-lg hover:bg-[#66121f] transition-colors text-lg font-bold mt-6",children:"שלח הזמנה"}),i&&e.jsx("div",{className:"text-center mt-4 text-green-600 font-semibold",children:i})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-6",children:"פרטי ההזמנה"}),e.jsxs("div",{className:"space-y-4",children:[r.map(j=>e.jsxs("div",{className:"flex gap-4 border-b pb-4",children:[e.jsx("img",{src:j.image_url||`https://via.placeholder.com/100x150.png?text=${encodeURIComponent(j.title)}`,alt:j.title,className:"w-20 h-28 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-[#112a55]",children:j.title}),e.jsx("p",{className:"text-sm text-gray-600",children:j.author}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("span",{className:"text-[#a48327] font-bold",children:[j.price," ₪"]}),e.jsxs("span",{className:"text-gray-600",children:["כמות: ",j.quantity]})]})]})]},j.id)),e.jsxs("div",{className:"border-t pt-4 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{children:'סה"כ לתשלום:'}),e.jsxs("span",{className:"text-[#7c1c2c]",children:[n()," ₪"]})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"* התשלום יתבצע במעמד המסירה או בשיחה טלפונית"})]})]})]})]})]})}function Xe(){return e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"תקנון האתר"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"כללי"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"תקנון זה מסדיר את תנאי השימוש באתר ספרי קודש תלפיות. השימוש באתר מהווה הסכמה לתנאים אלו."})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"רכישה באתר"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:'המחירים באתר כוללים מע"מ'}),e.jsx("li",{children:"התשלום מתבצע במעמד ההזמנה"}),e.jsx("li",{children:"ניתן לבטל עסקה בתוך 14 יום"}),e.jsx("li",{children:"הספרים נשלחים באריזה מאובטחת"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"פרטיות"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"אנו מתחייבים לשמור על פרטיות הלקוחות ולא להעביר מידע לצד שלישי ללא הסכמה מפורשת."})]})]})]})}function Ke(){return e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"מדיניות משלוחים"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"זמני משלוח"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"משלוח רגיל: 3-5 ימי עסקים"}),e.jsx("li",{children:"משלוח מהיר: עד 24 שעות"}),e.jsx("li",{children:"איסוף עצמי: זמין בשעות פעילות החנות"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"עלויות משלוח"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"משלוח חינם בקנייה מעל 250 ₪"}),e.jsx("li",{children:"משלוח רגיל: 25 ₪"}),e.jsx("li",{children:"משלוח מהיר: 45 ₪"}),e.jsx("li",{children:"איסוף עצמי: ללא עלות"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"אזורי חלוקה"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"אנו מספקים משלוחים לכל רחבי הארץ. זמני המשלוח עשויים להשתנות בהתאם למיקום."})]})]})]})}function es(){return e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"מדיניות החזרות"}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-8 space-y-6",children:[e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"תנאי החזרה"}),e.jsxs("ul",{className:"list-disc list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"ניתן להחזיר מוצרים עד 14 יום מיום הקבלה"}),e.jsx("li",{children:"המוצר חייב להיות במצב חדש וללא פגיעה"}),e.jsx("li",{children:"יש לשמור את חשבונית הקנייה"}),e.jsx("li",{children:"ההחזר הכספי יבוצע באמצעי התשלום המקורי"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"תהליך ההחזרה"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:"יש ליצור קשר עם שירות הלקוחות"}),e.jsx("li",{children:"קבלת אישור החזרה"}),e.jsx("li",{children:"שליחת המוצר בחזרה לחנות"}),e.jsx("li",{children:"בדיקת המוצר וביצוע ההחזר הכספי"})]})]}),e.jsxs("section",{children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-3",children:"החזר כספי"}),e.jsx("p",{className:"text-gray-700 leading-relaxed",children:"ההחזר הכספי יבוצע תוך 14 ימי עסקים מיום קבלת המוצר בחנות."})]})]})]})}function ss(){const a=[{question:"מהם זמני המשלוח?",answer:"משלוח רגיל: 3-5 ימי עסקים. משלוח מהיר: עד 24 שעות."},{question:"האם יש משלוח חינם?",answer:"כן, בקנייה מעל 250 ₪ המשלוח חינם."},{question:"מה מדיניות ההחזרות?",answer:"ניתן להחזיר מוצרים עד 14 יום מיום הקבלה, כל עוד המוצר במצב חדש."},{question:"האם ניתן לאסוף עצמאית מהחנות?",answer:"כן, ניתן לאסוף מהחנות בשעות הפעילות ללא עלות משלוח."},{question:"איך ניתן ליצור קשר?",answer:"ניתן ליצור קשר בטלפון 050-418-1216 או במייל info@talpiot-books.co.il"}];return e.jsxs("div",{className:"max-w-4xl mx-auto p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-[#112a55] mb-6",children:"שאלות נפוצות"}),e.jsx("div",{className:"bg-white rounded-xl shadow-lg p-8",children:e.jsx("div",{className:"space-y-6",children:a.map((r,n)=>e.jsxs("div",{className:"border-b last:border-0 pb-6 last:pb-0",children:[e.jsx("h2",{className:"text-xl font-bold text-[#a48327] mb-2",children:r.question}),e.jsx("p",{className:"text-gray-700",children:r.answer})]},n))})})]})}function ts({onClose:a}){const[r,n]=d.useState(""),[s,t]=d.useState(""),l=async o=>{o.preventDefault(),t("שולח...");try{console.log("📤 שולח בקשה ל-API עם האימייל:",r);const i=await fetch("/api/coupon",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r})});console.log("🔁 תגובה מהשרת:",i.status);const c=await i.text();i.ok?(console.log("✅ קופון נשלח בהצלחה:",c),t("הקופון נשלח לכתובת המייל שלך!"),setTimeout(()=>a(),2e3)):(console.error("❌ שגיאה מהשרת:",i.status,c),t("שגיאה בשליחה: "+c))}catch(i){console.error("❗ שגיאת רשת או JS:",i),t("שגיאה בשליחה. נסה שוב")}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 max-w-md w-full relative animate-slide-up shadow-2xl",children:[e.jsx("button",{onClick:a,className:"absolute left-4 top-4 text-gray-500 hover:text-gray-700 transition-colors",children:e.jsx(U,{size:24})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-[#112a55] mb-4",children:"🎉 מבצע מיוחד!"}),e.jsx("p",{className:"text-gray-600 text-lg mb-4",children:"הירשם עכשיו וקבל:"}),e.jsxs("ul",{className:"text-[#a48327] font-bold space-y-2 text-xl",children:[e.jsx("li",{className:"bg-[#fdf6ec] py-2 px-4 rounded-lg",children:"משלוח חינם בקנייה הראשונה"}),e.jsx("li",{className:"bg-[#fdf6ec] py-2 px-4 rounded-lg",children:"10% הנחה על כל ההזמנה"})]})]}),e.jsxs("form",{onSubmit:l,className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{type:"email",value:r,onChange:o=>n(o.target.value),placeholder:"הכנס את כתובת המייל שלך",required:!0,className:"w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-[#a48327] focus:ring-2 focus:ring-[#a48327] focus:ring-opacity-50 outline-none transition-all duration-200"})}),e.jsx("button",{type:"submit",className:"w-full bg-[#a48327] text-white py-3 rounded-lg hover:bg-[#8b6f1f] transition-colors text-lg font-semibold transform hover:scale-105 transition-transform duration-200",children:"קבל קופון"}),s&&e.jsx("p",{className:"text-center text-green-600 font-semibold animate-fade-in",children:s}),e.jsx("p",{className:"text-center text-gray-500 text-sm mt-4",children:"* הקופון תקף לשבוע מיום קבלתו"})]})]})})}function as(){const{items:a,isOpen:r,closeCart:n,removeItem:s,updateQuantity:t,getTotal:l,getItemsCount:o}=_();return r?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-end",children:e.jsxs("div",{className:"bg-white w-full max-w-md h-full flex flex-col animate-slide-in-right",children:[e.jsxs("div",{className:"p-4 bg-[#112a55] text-white flex justify-between items-center",children:[e.jsxs("h2",{className:"text-xl font-bold",children:["סל קניות (",o()," פריטים)"]}),e.jsx("button",{onClick:n,className:"hover:text-gray-300",children:e.jsx(U,{size:24})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:a.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{className:"text-xl mb-4",children:"סל הקניות ריק"}),e.jsx("button",{onClick:n,className:"text-[#112a55] hover:text-[#1a3c70] font-semibold",children:"המשך בקניות"})]}):a.map(i=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 flex gap-4",children:[e.jsx("img",{src:i.image_url||`https://via.placeholder.com/100x150.png?text=${encodeURIComponent(i.title)}`,alt:i.title,className:"w-20 h-28 object-cover rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h3",{className:"font-bold text-[#112a55]",children:i.title}),e.jsx("button",{onClick:()=>s(i.id),className:"text-red-500 hover:text-red-700",children:e.jsx(H,{size:18})})]}),e.jsx("p",{className:"text-sm text-gray-600",children:i.author}),e.jsxs("p",{className:"text-[#a48327] font-bold",children:[i.price," ₪"]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx("button",{onClick:()=>t(i.id,i.quantity-1),className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200",children:e.jsx(ye,{size:16})}),e.jsx("span",{className:"w-8 text-center",children:i.quantity}),e.jsx("button",{onClick:()=>t(i.id,i.quantity+1),className:"p-1 rounded-full bg-gray-100 hover:bg-gray-200",children:e.jsx(W,{size:16})})]})]})]},i.id))}),a.length>0&&e.jsxs("div",{className:"border-t p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between text-lg font-bold",children:[e.jsx("span",{children:'סה"כ לתשלום:'}),e.jsxs("span",{children:[l()," ₪"]})]}),e.jsx(m,{to:"/checkout",className:"block w-full bg-[#7c1c2c] text-white text-center py-3 rounded-lg hover:bg-[#66121f] transition-colors",onClick:n,children:"המשך לתשלום"})]})]})}):null}function ls(){console.log("🔵 App.jsx loaded");const{initialize:a}=z(),{initialize:r}=_(),[n,s]=d.useState(!1);return d.useEffect(()=>{console.log("⚙️ initializing auth & cart..."),a(),r()},[a,r]),d.useEffect(()=>{if(!localStorage.getItem("couponShown")){const l=setTimeout(()=>{console.log("🎁 showing coupon popup"),s(!0)},5e3);return()=>clearTimeout(l)}},[]),e.jsx(le,{children:e.jsxs("div",{dir:"rtl",className:"font-serif bg-[#f8f6f1] min-h-screen",children:[e.jsx(Me,{}),e.jsx("main",{className:"max-w-7xl mx-auto px-4 py-8",children:e.jsxs(V,{children:[e.jsx(v,{path:"/",element:e.jsxs("div",{className:"space-y-12",children:[console.log("🏠 Rendering home route"),e.jsx("section",{className:"bg-white rounded-2xl shadow-lg p-4",children:e.jsx(Fe,{})}),e.jsx("section",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:e.jsx(Re,{})}),e.jsx("section",{className:"bg-white rounded-2xl shadow-lg p-4",children:e.jsx(Ue,{})}),e.jsx("section",{className:"bg-white rounded-2xl shadow-lg p-8",children:e.jsx(Le,{})})]})}),e.jsx(v,{path:"/categories",element:e.jsx(Oe,{})}),e.jsx(v,{path:"/books/:id",element:e.jsx(Be,{})}),e.jsx(v,{path:"/about",element:e.jsx(We,{})}),e.jsx(v,{path:"/contact",element:e.jsx(Qe,{})}),e.jsx(v,{path:"/login",element:e.jsx(He,{})}),e.jsx(v,{path:"/user/*",element:e.jsx(Ze,{})}),e.jsx(v,{path:"/checkout",element:e.jsx(Ge,{})}),e.jsx(v,{path:"/terms",element:e.jsx(Xe,{})}),e.jsx(v,{path:"/shipping",element:e.jsx(Ke,{})}),e.jsx(v,{path:"/returns",element:e.jsx(es,{})}),e.jsx(v,{path:"/faq",element:e.jsx(ss,{})}),e.jsx(v,{path:"/admin",element:e.jsx(re,{})}),e.jsx(v,{path:"/admin/orders",element:e.jsx(ne,{})}),e.jsx(v,{path:"/admin/products",element:e.jsx(ie,{})}),e.jsx(v,{path:"/admin/reports",element:e.jsx(ce,{})}),e.jsx(v,{path:"*",element:e.jsx(Te,{})})]})}),e.jsx("footer",{className:"bg-[#112a55] text-white py-12 mt-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-[#1a3c70] rounded-2xl p-8 transform hover:scale-105 transition-transform duration-300 shadow-xl",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6 text-[#f9e79f] text-center",children:"צור קשר"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(F,{size:20,className:"rotate-90 text-[#f9e79f]"}),e.jsx("span",{children:"050-418-1216"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(J,{size:20,className:"text-[#f9e79f]"}),e.jsx("span",{children:"info@talpiot-books.co.il"})]}),e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx(Z,{size:20,className:"text-[#f9e79f]"}),e.jsx("span",{children:"א'-ה' 9:00-20:00"})]})]})]}),e.jsxs("div",{className:"bg-[#1a3c70] rounded-2xl p-8 transform hover:scale-105 transition-transform duration-300 shadow-xl",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6 text-[#f9e79f] text-center",children:"שירותים"}),e.jsxs("ul",{className:"space-y-3 text-center",children:[e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/shipping",children:"משלוחים לכל הארץ"})}),e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/contact",children:"הזמנות מיוחדות"})}),e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/contact",children:"כריכה ותיקון ספרים"})}),e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/contact",children:"ייעוץ מקצועי"})})]})]}),e.jsxs("div",{className:"bg-[#1a3c70] rounded-2xl p-8 transform hover:scale-105 transition-transform duration-300 shadow-xl",children:[e.jsx("h3",{className:"text-2xl font-bold mb-6 text-[#f9e79f] text-center",children:"מידע נוסף"}),e.jsxs("ul",{className:"space-y-3 text-center",children:[e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/terms",children:"תקנון האתר"})}),e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/shipping",children:"מדיניות משלוחים"})}),e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/returns",children:"מדיניות החזרות"})}),e.jsx("li",{className:"hover:text-[#f9e79f] transition-colors",children:e.jsx(m,{to:"/faq",children:"שאלות נפוצות"})})]})]})]}),e.jsx("div",{className:"mt-12 pt-6 border-t border-[#1a3c70] text-center",children:e.jsx("p",{children:"© כל הזכויות שמורות לספרי קודש תלפיות"})})]})}),n&&e.jsx(ts,{onClose:()=>s(!1)}),e.jsx(as,{})]})})}console.log("🟢 main.jsx loaded");const M=document.getElementById("root");M?console.log("✅ נמצא root:",M):console.error('❌ לא נמצא אלמנט עם id="root" בדף HTML!');oe.createRoot(M).render(e.jsx(de.StrictMode,{children:e.jsx(ls,{})}));console.log("🟢 ReactDOM.render הושלם");
